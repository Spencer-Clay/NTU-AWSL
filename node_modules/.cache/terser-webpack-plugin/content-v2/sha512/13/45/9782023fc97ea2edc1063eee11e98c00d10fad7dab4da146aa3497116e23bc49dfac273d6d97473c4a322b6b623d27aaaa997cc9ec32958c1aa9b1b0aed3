{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{1712:function(t,s,a){\"use strict\";a.r(s);var i=a(56),p=Object(i.a)({},(function(){var t=this,s=t.$createElement,i=t._self._c||s;return i(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[i(\"h1\",{attrs:{id:\"discuz-x-3-4-admincp-setting-php-后台sql注入漏洞\"}},[i(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#discuz-x-3-4-admincp-setting-php-后台sql注入漏洞\"}},[t._v(\"#\")]),t._v(\" Discuz!X 3.4 admincp_setting.php 后台SQL注入漏洞\")]),t._v(\" \"),i(\"h2\",{attrs:{id:\"漏洞描述\"}},[i(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞描述\"}},[t._v(\"#\")]),t._v(\" 漏洞描述\")]),t._v(\" \"),i(\"p\",[t._v(\"不久以前Discuz!X的后台披露了一个sql注入的漏洞，这里也要感谢漏洞的发现和研究者（无糖的kn1f3)。\")]),t._v(\" \"),i(\"h2\",{attrs:{id:\"影响版本\"}},[i(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#影响版本\"}},[t._v(\"#\")]),t._v(\" 影响版本\")]),t._v(\" \"),i(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v(\"Discuz!X <3.4 R20191201 版本\")]),i(\"br\"),t._v(\" \"),i(\"h2\",{attrs:{id:\"环境搭建\"}},[i(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#环境搭建\"}},[t._v(\"#\")]),t._v(\" 环境搭建\")]),t._v(\" \"),i(\"p\",[t._v(\"将 \"),i(\"strong\",[t._v(\"upload\")]),t._v(\"目录下的文件拷入\"),i(\"strong\",[t._v(\"phpstudy\")]),t._v(\"下的WWW目录打开网站按照步骤安装就行了\")]),t._v(\" \"),i(\"p\",[i(\"img\",{attrs:{src:a(515),alt:\"img\"}})]),t._v(\" \"),i(\"p\",[i(\"img\",{attrs:{src:a(516),alt:\"img\"}})]),t._v(\" \"),i(\"h2\",{attrs:{id:\"漏洞复现\"}},[i(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞复现\"}},[t._v(\"#\")]),t._v(\" 漏洞复现\")]),t._v(\" \"),i(\"p\",[t._v(\"来到后台页面, 在 \"),i(\"strong\",[t._v(\"UCenter 应用 ID\")]),t._v(\" 位置的参数添加单引号并抓包\")]),t._v(\" \"),i(\"p\",[i(\"img\",{attrs:{src:a(517),alt:\"img\"}})]),t._v(\" \"),i(\"p\",[t._v(\"发现出现SQL语句报错\")]),t._v(\" \"),i(\"p\",[i(\"img\",{attrs:{src:a(518),alt:\"img\"}})]),t._v(\" \"),i(\"p\",[t._v(\"使用报错注入去获取版本号\")]),t._v(\" \"),i(\"p\",[i(\"img\",{attrs:{src:a(519),alt:\"img\"}})]),t._v(\" \"),i(\"p\",[t._v(\"这里的参数为 \"),i(\"code\",[t._v(\"settingnew[uc][appid]\")])]),t._v(\" \"),i(\"p\",[t._v(\"查看文件 \"),i(\"strong\",[t._v(\"\\\\source\\\\admincp\\\\admincp_setting.php\")]),t._v(\"， 在2677行找到了输入点\")]),t._v(\" \"),i(\"p\",[i(\"img\",{attrs:{src:a(520),alt:\"img\"}})]),t._v(\" \"),i(\"p\",[t._v(\"根据报错语句找到SQL语句执行点，在文件\"),i(\"strong\",[t._v(\"uc_client\\\\model\\\\base.php\")]),t._v(\" 中的 206行\")]),t._v(\" \"),i(\"p\",[i(\"img\",{attrs:{src:a(521),alt:\"img\"}})]),t._v(\" \"),i(\"p\",[t._v(\"通过这里的语句可以看到我们可以使用 \"),i(\"strong\",[t._v(\"union注入\")]),t._v(\" 的方法来写入恶意文件(\"),i(\"strong\",[t._v(\"secure_file_priv不能为Null\")]),t._v(\")\")]),t._v(\" \"),i(\"p\",[i(\"img\",{attrs:{src:a(522),alt:\"img\"}})]),t._v(\" \"),i(\"div\",{staticClass:\"language-plain extra-class\"},[i(\"pre\",{pre:!0,attrs:{class:\"language-plain\"}},[i(\"code\",[t._v(\"1' union select \\\"<?php phpinfo();?>\\\"  into outfile 'D:/test.php';--+\\n\")])])]),i(\"p\",[t._v(\"也可以使用其他的方法\")])],1)}),[],!1,null,null,null);s.default=p.exports},515:function(t,s,a){t.exports=a.p+\"assets/img/discuz-1.48e77684.png\"},516:function(t,s,a){t.exports=a.p+\"assets/img/discuz-2.6ffcd67c.png\"},517:function(t,s,a){t.exports=a.p+\"assets/img/discuz-3.f6039b34.png\"},518:function(t,s,a){t.exports=a.p+\"assets/img/discuz-4.aad0dba6.png\"},519:function(t,s,a){t.exports=a.p+\"assets/img/discuz-5.fc49bfeb.png\"},520:function(t,s,a){t.exports=a.p+\"assets/img/discuz-6.72cbab0d.png\"},521:function(t,s,a){t.exports=a.p+\"assets/img/discuz-7.6f0b4f74.png\"},522:function(t,s,a){t.exports=a.p+\"assets/img/discuz-8.c57d9e76.png\"}}]);","extractedComments":[]}