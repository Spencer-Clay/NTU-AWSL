{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[476],{2254:function(s,t,a){\"use strict\";a.r(t);var n=a(75),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[a(\"h2\",{attrs:{id:\"🌀-dismap-asset-discovery-and-identification-tool\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#🌀-dismap-asset-discovery-and-identification-tool\"}},[s._v(\"#\")]),s._v(\" 🌀 Dismap - Asset discovery and identification tool\")]),s._v(\" \"),a(\"p\",[a(\"a\",{attrs:{href:\"https://github.com/zhzyker/dismap\"}},[a(\"img\",{attrs:{alt:\"Release\",src:\"https://img.shields.io/badge/golang-1.6+-9cf\"}})]),s._v(\" \"),a(\"a\",{attrs:{href:\"https://github.com/zhzyker/dismap\"}},[a(\"img\",{attrs:{alt:\"Release\",src:\"https://img.shields.io/badge/dismap-0.3-ff69b4\"}})]),s._v(\" \"),a(\"a\",{attrs:{href:\"https://github.com/zhzyker/dismap\"}},[a(\"img\",{attrs:{alt:\"Release\",src:\"https://img.shields.io/badge/LICENSE-GPL-important\"}})]),s._v(\" \"),a(\"img\",{attrs:{src:\"https://img.shields.io/github/stars/zhzyker/dismap?color=success\",alt:\"GitHub Repo stars\"}}),s._v(\" \"),a(\"img\",{attrs:{src:\"https://img.shields.io/github/forks/zhzyker/dismap\",alt:\"GitHub forks\"}}),s._v(\" \"),a(\"img\",{attrs:{src:\"https://img.shields.io/github/downloads/zhzyker/dismap/total?color=blueviolet\",alt:\"GitHub all release\"}})]),s._v(\" \"),a(\"p\",[s._v(\"Dismap 定位是一个资产发现和识别工具，他可以快速识别 Web/tcp/udp 等协议和指纹信息，定位资产类型，适用于内外网，辅助红队人员快速定位潜在风险资产信息，辅助蓝队人员探测疑似脆弱资产\")]),s._v(\" \"),a(\"p\",[s._v(\"Dismap 拥有完善的指纹规则库，目前包括 tcp/udp/tls 协议指纹和 4500+ Web 指纹规则，可以识别包括 favicon、body、header 等，   对于规则库的简介位于 \"),a(\"a\",{attrs:{href:\"https://github.com/zhzyker/dismap#-rulelab\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"RuleLab\"),a(\"OutboundLink\")],1)]),s._v(\" \"),a(\"p\",[a(\"s\",[s._v(\"扫描结果可直接丢给 \"),a(\"a\",{attrs:{href:\"https://github.com/zhzyker/vulmap\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"Vulmap\"),a(\"OutboundLink\")],1),s._v(\"(>=0.8) 进行漏洞扫描。\")]),s._v(\", 0.3 版本中改变了文本结果，新增了 json 文件结果，vulmap 将在 >= 1.0 支持联动\")]),s._v(\" \"),a(\"h2\",{attrs:{id:\"🏂-run\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#🏂-run\"}},[s._v(\"#\")]),s._v(\" 🏂 Run\")]),s._v(\" \"),a(\"p\",[s._v(\"Dismap 对 Linux、MacOS、Windows 均提供了二进制可执行文件，前往 \"),a(\"a\",{attrs:{href:\"https://github.com/zhzyker/dismap/releases\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"Release\"),a(\"OutboundLink\")],1),s._v(\" 下载对应版本即可运行:\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-Bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Linux or MacOS\")]),s._v(\"\\nzhzyker@debian:~$ \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chmod\")]),s._v(\" +x dismap-0.3-linux-amd64\\nzhzyker@debian:~$ ./dismap-0.3-linux-amd64 -h\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Windows\")]),s._v(\"\\nC:\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"Users\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"zhzyker\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"\\\\\")]),s._v(\"Desktop\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" dismap-0.3-windows-amd64.exe -h\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\")])]),a(\"blockquote\",[a(\"p\",[a(\"img\",{attrs:{src:\"https://github.com/zhzyker/zhzyker/blob/main/dismap-images/dismap-0.3.png\",alt:\"dismap\"}})])]),s._v(\" \"),a(\"h2\",{attrs:{id:\"🎡-options\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#🎡-options\"}},[s._v(\"#\")]),s._v(\" 🎡 Options\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-Bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[s._v(\"  -f, --file string     从文件中解析目标进行批量识别\\n  -h, --help            查看帮助说明\\n  -i, --ip string       指定一个网段 \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"示例 -i \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".1.0/24 or -i \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".1.1-10\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n  -j, --json string     扫描结果保存到 json 格式文件\\n  -l, --level int       指定日志等级 \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"0\")]),s._v(\":Fatal \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\":Error \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"2\")]),s._v(\":Info \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3\")]),s._v(\":Warning \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"4\")]),s._v(\":Debug \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"5\")]),s._v(\":Verbose\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),s._v(\"默认 \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n  -m, --mode string     指定要识别的协议 \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"e.g. -m mysql/-m http\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n      --nc              不打印字符颜色\\n      --np              不使用 ICMP/PING 检测存活主机\\n  -o, --output string   将扫描结果保存到指定文件 \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),s._v(\"默认 \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"output.txt\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n  -p, --port string     自定义要识别的端口 \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"示例 -p \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"80,443\")]),s._v(\" or -p\\t \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\"-65535\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n      --proxy string    使用代理进行扫描, 支持 http/socks5 协议代理 \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"示例 --proxy socks5://127.0.0.1:1080\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n  -t, --thread int      并发线程数量 \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),s._v(\"默认 \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"500\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n      --timeout int     超时时间 \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),s._v(\"默认 \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"5\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n      --type string     指定扫描类型 \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"示例 --type tcp/--type udp\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n  -u, --uri string      指定目标地址 \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"示例 -u https://example.com\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\")])]),a(\"h2\",{attrs:{id:\"🎨-examples\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#🎨-examples\"}},[s._v(\"#\")]),s._v(\" 🎨 Examples\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-Bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[s._v(\"zhzyker@debian:~$ ./dismap -i \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".1.1/24\\nzhzyker@debian:~$ ./dismap -i \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".1.1/24 -o result.txt -j result.json\\nzhzyker@debian:~$ ./dismap -i \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".1.1/24 --np --timeout \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"10\")]),s._v(\"\\nzhzyker@debian:~$ ./dismap -i \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".1.1/24 -t \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1000\")]),s._v(\"\\nzhzyker@debian:~$ ./dismap -u https://github.com/zhzyker/dismap\\nzhzyker@debian:~$ ./dismap -u mysql://192.168.1.1:3306\\nzhzyker@debian:~$ ./dismap -i \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"192.168\")]),s._v(\".1.1/24 -p \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\"-65535\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\")])]),a(\"h2\",{attrs:{id:\"⛪-discussion\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#⛪-discussion\"}},[s._v(\"#\")]),s._v(\" ⛪ Discussion\")]),s._v(\" \"),a(\"ul\",[a(\"li\",[s._v(\"Dismap Bug 反馈或新功能建议\"),a(\"a\",{attrs:{href:\"https://github.com/zhzyker/dismap/issues\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"点我\"),a(\"OutboundLink\")],1)]),s._v(\" \"),a(\"li\",[s._v(\"Twitter: https://twitter.com/zhzyker\")]),s._v(\" \"),a(\"li\",[s._v(\"WeChat: 扫码入群聊\\n\"),a(\"p\",[a(\"img\",{staticStyle:{\"max-width\":\"100%\"},attrs:{alt:\"QR-code\",src:\"https://github.com/zhzyker/zhzyker/blob/main/dismap_wechat_6.jpg\",width:\"20%\",height:\"20%\"}})])])]),s._v(\" \"),a(\"h2\",{attrs:{id:\"🌈-rulelab\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#🌈-rulelab\"}},[s._v(\"#\")]),s._v(\" 🌈 RuleLab\")]),s._v(\" \"),a(\"p\",[s._v(\"整个规则库是一个 struct 位于 \"),a(\"a\",{attrs:{href:\"https://github.com/zhzyker/dismap/blob/main/config/rule.go\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"rule.go\"),a(\"OutboundLink\")],1),s._v(\"\\n大致格式如下：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-Golang line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"Rule:\\nName: name /* 定义规则名称 */\\nType: header|body|ico  /* 支持识别的类型, header、body、ico 可任意逻辑组合, ico 为单独请求 favicon.ico 并计算 MD5*/\\nMode: and|or /* 类型的判断逻辑关系 */\\nRule\\nInBody: str  /* 需要指定响应 Body 中存在 str 则命中 */\\nInHeader: str  /* 需要指定响应 Hedaer 中存在 str 则命中 */\\nInIcoMd5: str_md5  /* favicon.ico 的 MD5 值 */\\nHttp:\\nReqMethod: GET|POST  /* 自定义请求方法,目前支持 GET 和 POST */\\nReqPath: str  /* 自定义请求 Web 路径 */\\nReqHeader: []str  /* 自定义 Http 请求的 Header */\\nReqBody: str  /* 自定义 POST 请求时的 Body */\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\")])]),a(\"p\",[a(\"strong\",[s._v(\"规则库示例1:\")])]),s._v(\" \"),a(\"p\",[s._v(\"即在响应Body中检查是否存在字符\"),a(\"code\",[s._v(\"<flink-root></flink-root>\")])]),s._v(\" \"),a(\"div\",{staticClass:\"language-Golang line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v('{\"Apahce Flink\", \"body\", \"\", InStr{\"(<flink-root></flink-root>)\", \"\", \"\"}, ReqHttp{\"\", \"\", nil, \"\"}},\\n')])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[a(\"strong\",[s._v(\"规则库示例2:\")])]),s._v(\" \"),a(\"p\",[s._v(\"自定义请求访问\"),a(\"code\",[s._v(\"/myportal/control/main\")]),s._v(\",判断自定义请求的结果中是否存在指定的 header 字符和 body 字符\"),a(\"br\"),s._v(\"\\n可以发现均支持正则表达式\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-Golang line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v('{\"Apache OFBiz\", \"body|header\", \"or\", InStr{\"(Apache OFBiz|apache.ofbiz)\", \"(Set-Cookie: OFBiz.Visitor=(.*))\", \"\"}, ReqHttp{\"GET\", \"/myportal/control/main\", nil, \"\"}},\\n')])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[a(\"strong\",[s._v(\"header, body, ico 的逻辑关系可以随意组合,但不可重复组合:\")])]),s._v(\" \"),a(\"p\",[s._v(\"允许: \"),a(\"code\",[s._v('\"body|header|ico\", \"or\"')]),s._v(\" or \"),a(\"code\",[s._v('\"body|header|ico\", \"or|and\"')]),s._v(\" or \"),a(\"code\",[s._v('\"body|ico\", \"and\"')]),a(\"br\"),s._v(\"\\n不允许: \"),a(\"code\",[s._v('\"body|body\", \"or\"')]),a(\"br\"),s._v(\"\\n重复组合不允许通过类型指定,但可通过 InBody 判断字符内实现: \"),a(\"code\",[s._v('\"body\", \"\", InStr{\"(str1|str2)\"}')])])])}),[],!1,null,null,null);t.default=e.exports}}]);","extractedComments":[]}